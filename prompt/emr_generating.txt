seer_template_introduction = """# Instruction
    Assume that you are a senior clinical medical researcher, and you now need to complete the following tasks:
        You will be given relevant information about a patient, including:
            1. Some basic information of the patient
            2. Some laboratory test results of the patient before treatment
            3. Some indicators of imaging examinations before treatment
            4. The patient's current staging such as T N M
        What you need to give is to generate an electronic medical record that looks real and conforms to the patient's situation based on these patient information. Several excellent examples of excellent clinical electronic medical records are as follows:
    At the same time, the patient information given may not directly contain all the necessary content in the electronic medical record. You need to generate a simulated clinical electronic medical record that does not contradict the existing information based on the existing information, and output all your considerations and ideas during the construction process.
    Your generated electronic medical record should include the following parts:
        1. PS: Patient's physical activity status, ranging from 0 to 4, where 4 means the patient is completely unable to take care of himself, and 0 means the patient is completely normal.
        2. Child-Pugh_score: The Child-Pugh score is a scoring system used to assess the prognosis of chronic liver disease, particularly cirrhosis. It is based on five clinical measures: total bilirubin, serum albumin, prothrombin time, ascites, and hepatic encephalopathy. The score ranges from A to C, with A indicating the best prognosis and C indicating the worst. Child-Pugh score can be calculated as follows: A: 5-6 points, B: 7-9 points, C: 10-15 points.
            A. Total bilirubin, μmol/L (1 point: < 34; 2 points: 34-50; 3 points: > 50)
            B. Serum albumin, g/dL (1 point: > 3.5; 2 points: 2.8-3.5; 3 points: < 2.8)
            C. Prothrombin time, seconds (1 point: < 4.0; 2 points: 4.0-6.0; 3 points: > 6.0)
            D. Ascites (1 point: none; 2 points: mild; 3 points: moderate to severe)
            E. Hepatic encephalopathy (1 point: none; 2 points: grade 1-2; 3 points: grade 3-4)
            (Score of Child-Pugh is calculated by the sum of the points of A, B, C, D and E)
        3. extrahepatic_metastasis: Whether there is extrahepatic metastasis, which can be "Yes" or "No".
        4. examination_related: The part of the generated electronic medical record related to the laboratory examination, pathological examination and imaging examination.
    You also need to generate a step-by-step thought process, which is a detailed description of how you constructed the electronic medical record, including your considerations and ideas during the construction process. This part should be in Chinese. Here is an example of how to write the thought process:
        "患者年龄为 90 岁，且肿瘤较大，病情较为严重，因此考虑身体状况可能较差，因此设定 PS 评分为 3，同时适当对总胆红素、血清白蛋白以及凝血酶原时间、腹水以及肝性脑病情况作出合理的假设：35(34-50),3.1(2.8-3.5),4.5(4.0-6.0),无腹水,无肝性脑病，因此进行计算，child-pugh 分数为2+2+2+1+1=8，属于 B 级。同时，根据给定的 'mets.x' 均为 0可见，没有肝外转移发生，在生成实验室检查的时候，我需要确保我给出的总胆红素与前面计算child-pugh分数的时候一致，为 35 μmol/L，同时在与现有病历不矛盾的情况下生成剩下的其他检查结果: 输入数据中显示AFP为1(阳性)，因此我将设定一个高于平均值的值(421 ng/mL)，同时，输入数据中显示肿瘤大小为52，并且纤维化情况为1（阳性），我将会体现于生存的影像报告中。"
    Your output must be in JSON format that can be directly parsed by json.loads() in Python. It cannot contain any other content. Specifically, the format is as follows:
        {{"thinking": <your-thinking-process>, "generated_electronic_medical_record": <Your-generated-medical-record>}}"""
# Example
seer_template_hint = """# Hint
    1. Some of the information given may be missing, which is shown as 'Blank(s)'.
    2. You are not allowed to output any other content except the JSON format specified above, such as "The answer is" or "The result is". Your output must be a valid JSON format that can be parsed by json.loads() in Python.
    3. Value of your output must be in Chinese, and the keys of your output must be in English.
    4. There will be information about the survival status of patient after treatment, like 'Survival.months', but because you cannot get these information while writing admission record, so you must pretend that you do not know these information, and do not output them in your generated electronic medical record.
    5. You should be careful about the date when generating EHR (The diagnosis year in this case is {YEAR}), to avoid that the patient is already dead in 2020, but you write the examination record of CT in 2023, which is not logical.
    6. When you want to mension the date of anything, do not use expression like '2023-xxxx', but use exact date like '2023-10-01'.
    7. Do not use 'Blank(s)' or 'Blank' in your output.
    8. Your generated electronic medical record should be in Chinese.
    9. Every '{{' in your generated answer should have a corresponding '}}' to avoid syntax error in JSON format.  
"""

seer_template_example = """# Example
   # Example 1
        {"PS": 1, "Child_Pugh": {"score": "A", "total_bilirubin": 30, "serum_albumin": 3.8, "prothrombin_time": 3.5, "ascites": "none", "hepatic_encelopathy": "none"}, "extrahepatic_metastasis": "No", "examination_related": {"laboratory_examination": {"白细胞计数": 5.8, "红细胞计数": 4.5, "血红蛋白": 140, "血小板计数": 180, "总胆红素": 30, "直接胆红素": 10, "间接胆红素": 20, "谷丙转氨酶": 35, "谷草转氨酶": 40, "碱性磷酸酶": 100, "γ-谷氨酰转肽酶": 50, "白蛋白": 3.8, "球蛋白": 2.0}, "pathological_examination": {"免疫组织化学染色诊断（病理科）": {"大体描述": "1.肝脏：部分肝组织切除标本，大小11.5*11*8cm，切缘面积11*8cm，肝脏被膜灰红色较光滑，距肝切缘3cm，紧邻被膜下可见一结节肿物，大小3*2.7*2cm，切面灰黄色实性质中，与周围组织界限清，其余肝组织切面灰黄色多结节状实性质中，结节直径0.5-1cm，留。", "镜下描述": "none", "初步诊断": "（肝脏）肝细胞癌亚型：非特指<BR>肿瘤大小：3cm×2.7cm×2cm<BR>组织学生长类型：细梁型<BR>组织学分级：中分化<BR>MV1提示风险分级：M1(低危组），≤5个MV1，且发生于近癌旁肝组织(≤1cm)<BR>神经侵犯：未见神经侵犯<BR>肝被膜：侵犯、未突破肝<BR>切缘：未见癌，距离肿瘤最近距离:3cm<BR>肿瘤周围肝评估：周围肝组织小叶结构紊乱，假小叶形成，部分肝细胞水样变，少许肝细胞大-小泡混合性脂肪变性，汇管区纤维组织及胆小管增生，纤维间隔形成，伴多量慢性炎细胞浸润，轻度界面炎，肝被膜下片状出血。综上，慢性病毒性肝炎，乙型，大-小混合性肝硬化，活动期。<BR>免疫组化：-4：CD31(血管+)、CD34(血管+)；-5：HepPar-1(+)、GPC3(-)、GS(-)、HSP70(+)、AFP(-)、CD34(毛细血管化)、CD10(-)、CK7(-)、CK19(-)、Ki67(40%+)；-7：HBsAg(+)、HBcAg(-)。<BR>&nbsp;&nbsp;&nbsp; 特殊染色：-5：网染(+)；-7：MASSON/网染(假小叶形成)。", "最终诊断": "（肝脏）肝细胞癌亚型：非特指<BR>肿瘤大小：3cm×2.7cm×2cm<BR>组织学生长类型：细梁型<BR>组织学分级：中分化<BR>MV1提示风险分级：M1(低危组），≤5个MV1，且发生于近癌旁肝组织(≤1cm)<BR>神经侵犯：未见神经侵犯<BR>肝被膜：侵犯、未突破<BR>肝切缘：未见癌，距离肿瘤最近距离:3cm<BR>肿瘤周围肝评估：周围肝组织小叶结构紊乱，假小叶形成，部分肝细胞水样变，少许肝细胞大-小泡混合性脂肪变性，汇管区纤维组织及胆小管增生，纤维间隔形成，伴多量慢性炎细胞浸润，轻度界面炎，肝被膜下片状出血。综上，慢性病毒性肝炎，乙型，大-小结节混合性肝硬化，活动期。<BR>免疫组化：-4：CD31(血管+)、CD34(血管+)；-5：HepPar-1(+)、GPC3(局灶+)、GS(-)、HSP70(+)、AFP(-)、CD34(毛细血管化)、CD10(-)、CK7(-)、CK19(-)、Ki67(50%+)；-7：HBsAg(+)、HBcAg(+)。<BR>特殊染色：-5：网染(+)；-7：MASSON/网染(假小叶形成)。"}}, "imaging_examination": {"上腹部CT扫描（平扫+重建）": {"影像学印象": "肝动脉栓塞术后改变，肝内占位<BR>胆汁淤积，胆囊结石待除外", "影像学所见": "对比2023-10-16日检查：<BR>肝脏形态规整、肝缘局部不规整，各叶比例正常。肝脏实质见结节、肿块，较大者约52x51mm，其内见少量气体密度影。<BR>门静脉不宽，肝内外胆管无扩张。<BR>胆囊增大，壁不厚，腔内密度欠均匀。<BR>胰腺形态、大小如常，实质内未见异常密度影。胰管无扩张，胰周脂肪间隙清楚。<BR>脾脏形态、位置、大小未见异常，实质内未见异常密度影。<BR>腹腔内及腹膜后未见肿大淋巴结。腹腔内未见积液征象。<BR>"}, "肝功能储备检测（肝胆胰外科）": {"R15值": "6.3"}, "胸部CT扫描（平扫+重建）": {"影像学所见": "双肺少量索条；双肺见实性微结节，大者位于右肺叶间裂旁（se4，im134），大小约5×4mm；左侧胸膜增厚。<BR>两肺门不大，结构清晰，气管、左右支气管及其大分支通畅。<BR>两侧肺门、纵隔及两侧腋窝内未见明确肿大淋巴结。<BR>扫及腹部，请结合相关检查。", "影像学印象": "双肺局限性索条<BR>双肺微结节，建议复查<BR>左侧胸膜增厚"}}}}
   # Example 2
        {"PS": 2, "Child_Pugh": {"score": "B", "total_bilirubin": 42, "serum_albumin": 3.1, "prothrombin_time": 2.0, "ascites": "none", "hepatic_encelopathy": "grade 1"}, "extrahepatic_metastasis": "No", "examination_related": {"laboratory_examination": {"白细胞计数": 6.5, "红细胞计数": 4.2, "血红蛋白": 130, "血小板计数": 200, "总胆红素": 42, "直接胆红素": 20, "间接胆红素": 22, "谷丙转氨酶": 45, "谷草转氨酶": 50, "碱性磷酸酶": 120, "γ-谷氨酰转肽酶": 60, "白蛋白": 3.1, "球蛋白": 2.5}, "pathological_examination": {"穿刺组织活检病理诊断": {"大体描述": "1.肝占位穿刺：灰白穿刺组织两条，长2-2.8cm，直径0.1cm，完。", "镜下描述": "none", "初步诊断": "（肝占位穿刺）穿刺坏死组织中可见少许肿瘤细胞，细胞排列呈巢状、团状，局灶呈管状，细胞大小不一，中度异型，局灶肿瘤细胞松散、胞质透明，可见核分裂像。<BR>IHC：HSP70(灶+)、HepPar-1(小灶+)、AFP(-)、GPC3(灶+)、GS(+)、CD34(血管+)、CK7(-)、CK19(+)。<BR>特殊染色：网染(肿瘤细胞＞3层)。<BR>综上，肝细胞癌，中分化，待大体标本进一步明确分型。&nbsp;&nbsp;&nbsp; 透明细胞型？", "最终诊断":"（肝占位穿刺）穿刺坏死组织中仅见少许肿瘤细胞，细胞排列呈巢状、团状，局灶呈管状，细胞大小不一，中度异型，局灶肿瘤细胞松散、胞质透明，可见核分裂像。<BR>IHC：HSP70(灶+)、HepPar-1(小灶+)、AFP(-)、GPC3(灶+)、GS(+)、CD34(血管+)、CK7(-)、CK19(+)。<BR>特殊染色：网染(肿瘤细胞＞3层)。<BR>综上，低分化肝细胞癌，考虑合并胆管癌，有效成分少，且变性坏死著，请结合和临床综合分析。"}}, "imaging_examination": {"上腹部CT增强扫描": {"影像学印象": "肝右叶占位性病变，考虑肝癌(巨块型)合并坏死出血<BR>胰颈部囊性病变<BR>胰腺体部可疑病变，建议追查<BR>左肾小囊肿", "影像学所见": "肝脏体积增大，包膜尚光滑，肝右叶见较大肿块影，大小约10.8*13.2*14.9cm，增强扫描动脉期肿块强化较明显，其内血供较丰富，内见大片状无强化低密度坏死灶，并可见“假包膜”形成，门脉期快速廓清，强化符合“快进快出”改变。门脉右支受压推移，未见明显充盈缺损改变；肝内外胆管无扩张。胆囊不大，壁不厚，腔内未见异常密度影。<BR>胰颈部区域见类圆形无强化稍低密度影，大小约12*8mm。胰腺体部见一团片状中度持续性强化肿块影，动脉期肿块强化较正常胰腺实质低，门脉期强化程度接近正常胰腺实质。胰管轻度扩张。胰周脂肪间隙清楚。<BR>脾脏体积稍增大，实质内未见异常强化影。<BR>双侧肾上腺大小、形态未见异常。<BR>左肾下极见一类圆形无强化稍低密度影，直径约4mm。<BR>腹腔内及腹膜后未见肿大淋巴结。腹腔内未见积液征象。"}}}}
"""